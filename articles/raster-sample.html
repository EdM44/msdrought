<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>raster-sample • msdrought</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="raster-sample">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">msdrought</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/average-daily.html">average-daily</a></li>
    <li><a class="dropdown-item" href="../articles/raster-sample.html">raster-sample</a></li>
    <li><a class="dropdown-item" href="../articles/Sample-Walkthrough.html">sample-walkthrough</a></li>
    <li><a class="dropdown-item" href="../articles/vector-from-raster.html">vector-from-raster</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EdM44/msdrought/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>raster-sample</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/EdM44/msdrought/blob/master/vignettes/raster-sample.Rmd" class="external-link"><code>vignettes/raster-sample.Rmd</code></a></small>
      <div class="d-none name"><code>raster-sample.Rmd</code></div>
    </div>

    
    
<p>The purpose of the msdrought package is to take the input of a series
of rainfall data and to extract some key information (such as dates,
rainfall intensity, duration of a rainfall period, and more) to
characterize the Mid-Summer Drought climatic phenomenon present in
Central America. This vignette will walk you through the process of
taking a raster input and extracting a the statistics for each cell of
the raster using the terra package.</p>
<p>Packages used in this vignette: <code>terra</code> and
<code>msdrought</code>. These should be installed.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># This loads the data included in the package, but you would attach your own</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"prcp_cropped.tif"</span>, package <span class="op">=</span> <span class="st">"msdrought"</span><span class="op">)</span> </span>
<span><span class="va">infile</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<p>Now we have our raster data loaded in as “infile”. Using the
terra::app command, we can apply a function to each cell of the data.
For the purpose of this vignette, we will be obtaining the
<strong>intensity</strong> of each cell, but the MSD package is capable
of far more than this. See the <code>?MSD::msdStats</code> page for more
info.</p>
<p>Begin by finding the range of dates for the raster data, as these
values are needed for the package to understand the statistics. Data
processing begins by filtering the data using a Bartlett noise filter,
then apply the <code>msdStats</code> function to the data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Find the key dates related to the MSD</span></span>
<span><span class="co"># msdDates = msdDates(x, firstStartDate, firstEndDate, secondStartDate, secondEndDate)</span></span>
<span><span class="va">formattedDates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/yearmon.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/time.html" class="external-link">time</a></span><span class="op">(</span><span class="va">infile</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">keyDatesTS</span> <span class="op">&lt;-</span> <span class="fu">msdrought</span><span class="fu">::</span><span class="fu"><a href="../reference/msdDates.html">msdDates</a></span><span class="op">(</span><span class="va">formattedDates</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use the terra::app function to apply the Bartlett noise filter (msdFilter) to the raster</span></span>
<span><span class="co"># msdFilter = msdFilter(x, window)</span></span>
<span><span class="va">filtered</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/app.html" class="external-link">app</a></span><span class="op">(</span><span class="va">infile</span>, <span class="fu">msdrought</span><span class="fu">::</span><span class="va"><a href="../reference/msdFilter.html">msdFilter</a></span>, window <span class="op">=</span> <span class="fl">31</span>, quantity <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/time.html" class="external-link">time</a></span><span class="op">(</span><span class="va">filtered</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">formattedDates</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">filtered</span><span class="op">[[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="raster-sample_files/figure-html/dates-3-1.png" width="700">
Calculate the intensity for the spatrast object.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">intensity</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/app.html" class="external-link">app</a></span><span class="op">(</span><span class="va">filtered</span>, fun<span class="op">=</span><span class="fu">msdrought</span><span class="fu">::</span><span class="va"><a href="../reference/msdStats.html">msdStats</a></span>, dates<span class="op">=</span><span class="va">keyDatesTS</span>, fcn<span class="op">=</span><span class="st">"intensity"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'quantmod':</span></span>
<span><span class="co">#&gt;   method            from</span></span>
<span><span class="co">#&gt;   as.zoo.data.frame zoo</span></span>
<span><span class="va">year1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">format.Date</a></span><span class="op">(</span><span class="va">formattedDates</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"%Y"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">year2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">format.Date</a></span><span class="op">(</span><span class="va">formattedDates</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">formattedDates</span><span class="op">)</span><span class="op">]</span>, <span class="st">"%Y"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/time.html" class="external-link">time</a></span><span class="op">(</span><span class="va">intensity</span>, tstep <span class="op">=</span> <span class="st">"years"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">year1</span><span class="op">:</span><span class="va">year2</span></span></code></pre></div>
<p>From this, we have achieved our goal of finding all the intensity
values for every cell of the raster data set. This data can be viewed
via the terra::plot function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">intensity</span><span class="op">)</span></span></code></pre></div>
<p><img src="raster-sample_files/figure-html/fig-3-1.png" width="70%" style="display: block; margin: auto;"></p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Turner Uyeda, Ed Maurer, Iris Stewart-Frey, Kenneth Joseph, Alex Avila.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
